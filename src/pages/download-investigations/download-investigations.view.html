<ion-header>
  <ion-navbar>
    <ion-title>
      Download Investigations
    </ion-title>
  </ion-navbar>

  <ion-toolbar>
    <ion-segment>
      <ion-segment-button value="1">
      </ion-segment-button>
      <ion-segment-button value="2" (click)="openSortOptions()">
        Sort
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-list *ngIf="investigations?.length>0">
    <ion-item *ngFor="let investigation of investigations" (click)="openDetailsPanel(investigation._id)" text-wrap>
      <h2 text-bold>{{ investigation.labTitle }}</h2>
      <h5>Created by: {{ investigation.createdBy?.name }}</h5>

      <div *ngIf="visibleDetailsPanelId === investigation._id">
        <br>
        <h5>Creator's email: {{ investigation.createdBy?.email }}</h5>
        <h5>Updated at: {{ investigation.lastUpdatedAt }}</h5>
        <h5>Description: {{ investigation.description }}</h5>
        <br>
        <button ion-button color="secondary" full (click)="downloadInvestigation(investigation)" *ngIf="!isInvestigationLocal(investigation)">Download</button>
        <button ion-button color="primary" full (click)="openInvestigationDetails(investigation)" *ngIf="isInvestigationLocal(investigation)">Open</button>
        <button ion-button color="secondary" full (click)="updateInvestigation(investigation)" *ngIf="isInvestigationLocal(investigation)">Update</button>
        <br>
        <button ion-button color="danger" full (click)="deleteInvestigation(investigation)" *ngIf="isInvestigationLocal(investigation)">Delete</button>
      </div>
    </ion-item>
  </ion-list>
</ion-content>

<ion-footer>
  <button ion-button color="secondary" full no-margin (click)="openFilterOptions()">
    Filter
  </button>
</ion-footer>
